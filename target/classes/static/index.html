<!-- 系統前置 -->
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>祥易機車材料零件管理系統</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<!--側邊系統  -->
    <div class="sidebar">
        <div class="logo-area">祥易機車材料零件管理</div>
        <ul class="nav-menu">
            <li class="nav-item active" onclick="switchMode('entry', this, '門市現銷作業')">
                <i class="fas fa-cash-register"></i> 1. 銷貨
            </li>
            
            <li class="nav-item" onclick="switchMode('construction', this, '進貨管理')">
                <i class="fas fa-truck-loading"></i> 2. 進貨
            </li>
            <li class="nav-item" onclick="switchMode('construction', this, '結帳作業')">
                <i class="fas fa-file-invoice-dollar"></i> 3. 結帳
            </li>
            <li class="nav-item" onclick="switchMode('construction', this, '標籤列印')">
                <i class="fas fa-tags"></i> 4. 標籤
            </li>
            
            <li class="nav-item" onclick="switchMode('import', this)">
                <i class="fas fa-boxes"></i> 5. 商品 (匯入)
            </li>
            
            <li class="nav-item" onclick="switchMode('construction', this, '客戶管理')">
                <i class="fas fa-users"></i> 6. 客戶
            </li>
            <li class="nav-item" onclick="switchMode('construction', this, '廠商管理')">
                <i class="fas fa-industry"></i> 7. 廠商
            </li>
            <li class="nav-item" onclick="switchMode('construction', this, '其他資料')">
                <i class="fas fa-folder-open"></i> 8. 其他資料
            </li>
            <li class="nav-item" onclick="switchMode('construction', this, '系統備份')">
                <i class="fas fa-database"></i> 9. 備份
            </li>
            <li class="nav-item" onclick="exitSystem()">
                <i class="fas fa-sign-out-alt"></i> 0. 退出
            </li>
        </ul>
    </div>
<!-- 上方系統 -->
    <div class="main-content">
        
        <div class="top-bar" id="sales-top-menu">
            
            <div class="mobile-menu-btn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i>
            </div>

            <div class="top-pill active" onclick="switchMode('entry', this, '門市現銷作業')">1. 門市現銷</div>
            
            <div class="top-pill" onclick="switchMode('entry', this, '銷貨登記作業')">2. 銷貨登記</div>
            
            <div class="top-pill" onclick="switchMode('entry', this, '銷貨查詢作業')">3. 銷貨查詢</div>
            
            <div class="top-pill" onclick="switchMode('browse', this, '瀏覽式查詢')">4. 瀏覽式查詢</div>
            
            <div class="top-pill" onclick="switchMode('stats', this, '銷貨統計作業')">5. 銷貨統計</div>
            
            <div class="top-pill" onclick="switchMode('analysis', this, '銷貨分析作業')">6. 銷貨分析</div>
            
            <div class="top-pill" onclick="switchMode('daily-stats', this, '每日銷貨統計')">7. 每日銷貨統計</div>
            
            <div class="top-pill" onclick="switchMode('replenishment', this, '補貨統計作業')">8. 補貨統計</div>
            
            <div class="top-pill" onclick="switchMode('construction', this, '銷售商品統計')">9. 銷售商品統計</div>
            <div class="top-pill" onclick="switchMode('construction', this, '修改附單訊息')">10. 修改附單訊息</div>

            <div style="width: 1px; height: 20px; background: #cbd5e1; margin: 0 5px;"></div>

            <div class="dropdown-wrapper" onclick="toggleDropdown(this)">
                <div class="top-pill">A. 銷貨退貨 <i class="fas fa-chevron-down"></i></div>
                <div class="dropdown-menu">
                    <div class="dropdown-item" onclick="switchMode('entry', this, '退貨登記作業')">1. 退貨登記</div>
                    <div class="dropdown-item" onclick="switchMode('entry', this, '退貨查詢作業')">2. 退貨查詢</div>
                    <div class="dropdown-item" onclick="switchMode('browse', this, '瀏覽式退貨查詢')">3. 瀏覽式退貨查詢</div>
                    <div class="dropdown-item" onclick="switchMode('stats', this, '退貨統計作業')">4. 退貨統計</div>
                    <div class="dropdown-item" onclick="switchMode('analysis', this, '退貨分析作業')">5. 退貨分析</div>
                </div>
            </div>
            
            <div class="dropdown-wrapper" onclick="toggleDropdown(this)">
                <div class="top-pill">B. 報價作業 <i class="fas fa-chevron-down"></i></div>
                <div class="dropdown-menu">
                    <div class="dropdown-item" onclick="switchMode('construction', this, '報價登記')">1. 報價登記</div>
                    <div class="dropdown-item" onclick="switchMode('construction', this, '報價查詢')">2. 報價查詢</div>
                    <div class="dropdown-item" onclick="switchMode('construction', this, '瀏覽式報價查詢')">3. 瀏覽式報價查詢</div>
                    <div class="dropdown-item" onclick="switchMode('construction', this, '報價統計')">4. 報價統計</div>
                    <div class="dropdown-item" onclick="switchMode('construction', this, '報價分析')">5. 報價分析</div>
                </div>
            </div>

             <div class="dropdown-wrapper" onclick="toggleDropdown(this)">
                <div class="top-pill"><i class="fas fa-cog"></i> 其它設定</div>
                <div class="dropdown-menu">
                    <div class="dropdown-item" onclick="switchMode('construction', this, '設定出貨單格式')">C. 設定出貨單格式</div>
                    <div class="dropdown-item" onclick="switchMode('construction', this, '出貨單列印位置')">D. 出貨單列印位置調整</div>
                    <div class="dropdown-item" onclick="switchMode('construction', this, '出貨單字體大小')">E. 出貨單字體大小調整設定 </div>
                    <div class="dropdown-item" onclick="switchMode('construction', this, '一覽表列印位置')">F. 一覽表列印位置調整</div>
                </div>
            </div>
        </div>
<!-- 門市現銷作業內容 -->
        <div class="workspace">
            <div style="padding-left:5px; font-size:16px; font-weight:bold; color:var(--primary-color);">
                <i class="fas fa-angle-right"></i> <span id="current-mode-title">門市現銷作業</span>
            </div>

            <div id="view-sales-entry">
                <div class="panel-box form-header" style="position: relative;">
                    <div class="total-float" id="sales-total-display">$0</div>

                    <div class="header-row">
                        <div class="form-group"><label>編號</label><input type="text" class="header-input" value="自動生成" disabled style="background:#f1f5f9;"></div>
                        <div class="form-group"><label>日期</label><input type="date" class="header-input" id="sales-date"></div>
                        <div class="form-group" style="background: #fffbeb; padding: 2px 5px; border-radius: 4px; border: 1px solid #fcd34d;">
                            <label>帳款月份</label><input type="month" class="header-input" id="billing-month">
                        </div>
                    </div>
                    <div class="header-row">
                        <div class="form-group"><label>客戶代號</label><input type="text" class="header-input" id="sales-cust" placeholder="代號/掃描"></div>
                        <div class="form-group"><label>客戶名稱</label><input type="text" class="header-input name-input" id="sales-cust-name" placeholder="自動帶出名稱"></div>
                        <div class="form-group"><label>客戶地址</label><input type="text" class="header-input addr-input" id="sales-addr" placeholder="送貨地址"></div>
                    </div>
                </div>

                <div class="grid-wrapper panel-box">
                    <div class="grid-container">
                        <table id="sales-table">
                            <thead>
                                <tr>
                                    <th width="40">序</th><th width="120">商品代號</th><th width="100">車種</th><th>商品名稱</th><th width="60">數量</th><th width="80">單價</th>
                                    <th width="120" class="price-col">金額 ( <select class="price-select" onchange="changePriceType(this)"><option>散客價</option><option>車行價</option><option>廠商價</option></select> )</th>
                                    <th width="100">備註</th><th width="80">儲位</th>
                                </tr>
                            </thead>
                            <tbody id="sales-list"></tbody>
                        </table>
                    </div>
                </div>

                <div class="footer-info-panel">
                    <div class="footer-row">
                        <label class="tiny-label">備註:</label> 
                        <input type="text" class="header-input long-input" id="footer-note">
                        
                        <label class="tiny-label">運送:</label> 
                        <select class="header-input" id="footer-ship">
                            <option>送達</option><option>自取</option><option>貨運</option>
                        </select>

                        <label class="tiny-label">稅別:</label> 
                        <select class="header-input" id="footer-tax-type">
                            <option>內含</option><option>外加</option><option>未稅</option>
                        </select>

                        <label class="tiny-label">稅金:</label> 
                        <input type="number" class="small-input" id="footer-tax-amt">

                        <label class="tiny-label">扣%:</label> 
                        <input type="number" class="small-input" style="width:50px" id="footer-discount-rate" value="0">

                        <label class="tiny-label">折讓:</label> 
                        <input type="number" class="small-input" id="footer-discount-amt">
                    </div>

                    <div class="footer-row">
                        <label class="tiny-label">核對:</label> <input type="text" class="small-input">
                        <label class="tiny-label">送貨:</label> <input type="text" class="small-input">
                        <label class="tiny-label">包裝:</label> <input type="text" class="small-input">
                        <label class="tiny-label">撿貨:</label> <input type="text" class="small-input">
                        <label class="tiny-label">業務:</label> <input type="text" class="small-input">
                        <label class="tiny-label">製表:</label> <input type="text" class="small-input" value="管理員" readonly>
                    </div>
                </div>

                <div class="panel-box footer-bar">
                    <div style="flex-grow:1;"></div> <div class="btn-group">
                        <button class="btn btn-blue" onclick="alert('功能開發中')"><i class="fas fa-edit"></i> 修改</button>
                        <button class="btn btn-green" onclick="saveSales(true)"><i class="fas fa-print"></i> 存檔+印表</button>
                        <button class="btn btn-green" onclick="saveSales(false)"><i class="fas fa-save"></i> 存檔 (G)</button>
                        <button class="btn btn-red" onclick="clearOrder()"><i class="fas fa-trash-alt"></i> 刪除</button>
                        <button class="btn btn-blue" onclick="addSalesRow()"><i class="fas fa-plus"></i> 插入一行</button>
                        <button class="btn btn-gray" onclick="exitSystem()"><i class="fas fa-sign-out-alt"></i> 退出</button>
                    </div>
                </div>
            </div>
<!-- 瀏覽式查詢內容 -->
            <div id="view-sales-browse" style="display:none;">
                <div class="panel-box search-panel">
                    <div class="search-left">
                        <div class="search-warning">搜尋 (除年月份外，其他項目有輸入才過濾!!)</div>
                        <div class="search-fields">
                            <label>年月 從:</label> <input type="month" class="header-input" value="2026-02">
                            <label>到:</label> <input type="month" class="header-input" value="2026-02">
                            <button class="btn btn-blue" onclick="mockSearch()">開始查詢</button>
                            
                            <label>銷貨日期:</label> <input type="date" class="header-input">
                            <label>客戶代號:</label> <input type="text" class="header-input input-highlight">
                            <button class="btn btn-gray">結束查詢</button>

                            <label>帳款月份:</label> <input type="month" class="header-input">
                            <label>商品代號:</label> <input type="text" class="header-input">
                            <div style="font-size:13px;"><input type="radio" name="sort" checked> 反向 <input type="radio" name="sort"> 正向</div>
                        </div>
                    </div>
                    <div class="stats-box">
                        <div class="stats-title">本次查詢合計金額</div>
                        <div class="stats-amount">$0</div>
                    </div>
                </div>

                <div class="split-view">
                    <div class="master-grid panel-box" style="padding:0; overflow:hidden;">
                        <div class="grid-header-label"><i class="fas fa-list"></i> 銷貨單列表</div>
                        <div class="grid-container">
                            <table class="browse-table">
                                <thead><tr><th>序</th><th>單號</th><th>日期</th><th>客戶</th><th>金額</th></tr></thead>
                                <tbody id="browse-master-list"><tr><td colspan="5" style="text-align:center;">請按開始查詢...</td></tr></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="detail-grid panel-box" style="padding:0; overflow:hidden;">
                        <div class="grid-header-label"><i class="fas fa-info-circle"></i> 單據明細</div>
                        <div class="grid-container">
                            <table class="browse-table">
                                <thead><tr><th>序</th><th>商品代號</th><th>品名</th><th>數量</th><th>單價</th><th>金額</th></tr></thead>
                                <tbody id="browse-detail-list"><tr><td colspan="6" style="text-align:center;">---</td></tr></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
<!-- 銷貨統計內容 -->
            <div id="view-sales-stats" style="display:none; flex-direction:column; align-items:center; padding-top:20px;">
                <div class="panel-box" style="width: 500px; display:flex; flex-direction:column; gap:20px; border-top: 4px solid var(--primary-color);">
                    
                    <div style="font-size:18px; font-weight:bold; color:var(--primary-color); border-bottom:1px solid #eee; padding-bottom:10px;">
                        <i class="fas fa-chart-pie"></i> 銷貨統計條件設定
                    </div>

                    <div class="form-group-row">
                        <label style="width:100px;">期間範圍:</label>
                        <div style="display:flex; gap:10px; align-items:center;">
                            <input type="date" id="stats-date-start" class="header-input">
                            <span>至</span>
                            <input type="date" id="stats-date-end" class="header-input">
                        </div>
                    </div>

                    <div class="panel-box" style="background:#f8fafc; border:1px solid #e2e8f0;">
                        <label style="display:block; margin-bottom:10px; color:#64748b;">統計對象:</label>
                        <div style="display:flex; gap:15px; flex-wrap:wrap;">
                            <label class="radio-label"><input type="radio" name="stats-target" value="N"> N.編號</label>
                            <label class="radio-label"><input type="radio" name="stats-target" value="D" checked> D.日期</label>
                            <label class="radio-label"><input type="radio" name="stats-target" value="C"> C.客戶</label>
                            <label class="radio-label"><input type="radio" name="stats-target" value="I"> I.商品</label>
                        </div>
                    </div>

                    <div class="form-group-row">
                        <label style="width:100px;">統計範圍:</label>
                        <div style="display:flex; gap:10px; align-items:center;">
                            <input type="text" id="stats-range-start" class="header-input" placeholder="起始條件">
                            <span>至</span>
                            <input type="text" id="stats-range-end" class="header-input" placeholder="結束條件">
                        </div>
                    </div>

                    <div class="form-group-row">
                        <label style="width:100px;">印表機:</label>
                        <select class="header-input" style="width:100%;">
                            <option>Microsoft Print to PDF</option>
                            <option>標籤機 (Label)</option>
                            <option>出貨單印表機</option>
                        </select>
                    </div>

                    <div class="panel-box" style="background:#f8fafc; border:1px solid #e2e8f0;">
                        <label style="display:block; margin-bottom:10px; color:#64748b;">輸出選項:</label>
                        <div style="display:flex; gap:15px;">
                            <label class="radio-label"><input type="radio" name="stats-output" value="S" checked> S.螢幕</label>
                            <label class="radio-label"><input type="radio" name="stats-output" value="P"> P.印表機</label>
                            <label class="radio-label"><input type="radio" name="stats-output" value="D"> D.文件(Excel)</label>
                        </div>
                    </div>

                    <div style="display:flex; justify-content:center; gap:20px; margin-top:10px;">
                        <button class="btn btn-blue" style="padding: 10px 30px; font-size:16px;" onclick="runStats()">
                            <i class="fas fa-play"></i> G.開始
                        </button>
                        <button class="btn btn-gray" style="padding: 10px 30px; font-size:16px;" onclick="switchMode('entry', document.querySelector('.top-pill.active'), '門市現銷作業')">
                            <i class="fas fa-sign-out-alt"></i> Q.退出
                        </button>
                    </div>
                </div>

                <div id="stats-result-panel" class="panel-box" style="width: 100%; margin-top:20px; display:none; flex-direction:column;">
                    <div class="grid-header-label"><i class="fas fa-table"></i> 統計結果預覽</div>
                    <div class="grid-container" style="height: 300px; overflow:auto;">
                        <table class="browse-table">
                            <thead>
                                <tr><th>統計項目</th><th>數量</th><th>未稅金額</th><th>稅額</th><th>含稅總額</th></tr>
                            </thead>
                            <tbody id="stats-result-list"></tbody>
                        </table>
                    </div>
                    <div style="text-align:right; padding:10px; font-weight:bold; font-size:18px; color:var(--primary-color);">
                        總計: <span id="stats-total-display">$0</span>
                    </div>
                </div>
            </div>
<!-- 銷貨分析條件內容 -->
            <div id="view-sales-analysis" style="display:none; flex-direction:column; align-items:center; padding-top:20px;">
                <div class="panel-box" style="width: 700px; display:flex; flex-direction:column; gap:20px; border-top: 4px solid var(--primary-color);">
                    
                    <div style="font-size:18px; font-weight:bold; color:var(--primary-color); border-bottom:1px solid #eee; padding-bottom:10px;">
                        <i class="fas fa-chart-line"></i> 銷貨分析條件設定
                    </div>

                    <div class="analysis-grid">
                        <div class="analysis-box">
                            <div class="analysis-box-title">日期範圍</div>
                            <div class="range-row"><div class="range-label">從:</div><input type="date" class="header-input" id="ana-date-start" style="width:100%"></div>
                            <div class="range-row"><div class="range-label">到:</div><input type="date" class="header-input" id="ana-date-end" style="width:100%"></div>
                        </div>

                        <div class="analysis-box">
                            <div class="analysis-box-title">商品範圍</div>
                            <div class="range-row"><div class="range-label">從:</div><input type="text" class="header-input" style="width:100%"></div>
                            <div class="range-row"><div class="range-label">到:</div><input type="text" class="header-input" style="width:100%"></div>
                        </div>

                        <div class="analysis-box">
                            <div class="analysis-box-title">客戶範圍</div>
                            <div class="range-row"><div class="range-label">從:</div><input type="text" class="header-input" style="width:100%"></div>
                            <div class="range-row"><div class="range-label">到:</div><input type="text" class="header-input" style="width:100%"></div>
                        </div>

                        <div class="analysis-box">
                            <div class="analysis-box-title">備註範圍</div>
                            <div class="range-row"><div class="range-label">從:</div><input type="text" class="header-input" style="width:100%"></div>
                            <div class="range-row"><div class="range-label">到:</div><input type="text" class="header-input" style="width:100%"></div>
                        </div>
                    </div>

                    <div class="panel-box" style="background:#f8fafc; border:1px solid #e2e8f0; display:flex; gap:20px; align-items:center;">
                        <label style="font-weight:bold; color:#64748b;">商品排列:</label>
                        <label class="radio-label"><input type="radio" name="ana-sort" checked> M.混合排列</label>
                        <label class="radio-label"><input type="radio" name="ana-sort"> R.相同排一起</label>
                    </div>

                    <div style="display:flex; gap:20px;">
                        <div class="panel-box" style="background:#f8fafc; border:1px solid #e2e8f0; flex:1;">
                            <label style="display:block; margin-bottom:10px; font-weight:bold; color:#64748b;">輸出選項:</label>
                            <div style="display:flex; gap:15px;">
                                <label class="radio-label"><input type="radio" name="ana-output" value="S" checked> S.螢幕</label>
                                <label class="radio-label"><input type="radio" name="ana-output" value="P"> P.印表機</label>
                            </div>
                        </div>
                        <div class="panel-box" style="background:#f8fafc; border:1px solid #e2e8f0; flex:1;">
                            <label style="display:block; margin-bottom:5px; font-weight:bold; color:#64748b;">印表機:</label>
                            <select class="header-input" style="width:100%;"><option>Microsoft Print to PDF</option></select>
                        </div>
                    </div>

                    <div style="display:flex; justify-content:center; gap:20px; margin-top:10px;">
                        <button class="btn btn-blue" style="padding: 10px 30px; font-size:16px;" onclick="runAnalysis()">
                            <i class="fas fa-play"></i> G.開始
                        </button>
                        <button class="btn btn-gray" style="padding: 10px 30px; font-size:16px;" onclick="switchMode('entry', document.querySelector('.top-pill.active'), '門市現銷作業')">
                            <i class="fas fa-sign-out-alt"></i> Q.退出
                        </button>
                    </div>
                </div>

                <div id="analysis-result-panel" class="panel-box" style="width: 100%; margin-top:20px; display:none; flex-direction:column;">
                    <div class="grid-header-label"><i class="fas fa-list"></i> 分析結果列表</div>
                    <div class="grid-container" style="height: 300px; overflow:auto;">
                        <table class="browse-table">
                            <thead>
                                <tr><th>日期</th><th>客戶名稱</th><th>商品名稱</th><th>規格</th><th>數量</th><th>單價</th><th>金額</th><th>備註</th></tr>
                            </thead>
                            <tbody id="analysis-result-list"></tbody>
                        </table>
                    </div>
                </div>
            </div>
<!-- 每日銷貨統計內容 -->
            <div id="view-daily-stats" style="display:none; flex-direction:column; height:100%; gap:15px;">
                
                <div class="panel-box search-panel" style="flex-shrink:0; align-items:center; gap:20px;">
                    
                    <div style="font-size:18px; font-weight:bold; color:var(--primary-color);">
                        <i class="fas fa-calendar-alt"></i> 統計條件
                    </div>

                    <div style="display:flex; align-items:center; gap:10px;">
                        <label class="search-label">月份:</label>
                        <input type="month" id="daily-stats-month" class="header-input" style="width:150px;">
                    </div>

                    <div style="display:flex; align-items:center; gap:15px; background:#fff; padding:5px 15px; border:1px solid #cbd5e1; border-radius:20px;">
                        <label class="radio-label"><input type="radio" name="daily-type" value="1" checked> 1.帳款月份</label>
                        <label class="radio-label"><input type="radio" name="daily-type" value="2"> 2.銷貨日期</label>
                    </div>

                    <div style="display:flex; align-items:center; gap:10px;">
                        <label class="search-label">印表機:</label>
                        <select class="header-input" style="width:180px;">
                            <option>Microsoft Print to PDF</option>
                            <option>一般雷射印表機</option>
                        </select>
                    </div>

                    <button class="btn btn-blue" onclick="runDailyStats()">
                        <i class="fas fa-calculator"></i> G.開始計算
                    </button>
                    
                    <button class="btn btn-green" onclick="alert('已發送至印表機')">
                        <i class="fas fa-print"></i> P.列印
                    </button>
                </div>

                <div class="panel-box" style="flex-grow:1; display:flex; flex-direction:column; padding:0; overflow:hidden;">
                    <div class="grid-header-label">
                        <i class="fas fa-table"></i> 每日統計列表
                        <span id="daily-stats-info" style="margin-left:auto; font-weight:normal; color:#64748b;">請按開始計算...</span>
                    </div>
                    
                    <div class="grid-container">
                        <table class="browse-table">
                            <thead>
                                <tr>
                                    <th width="60">日期</th>
                                    <th>銷貨金額</th>
                                    <th width="60">張數</th>
                                    <th>退貨金額</th>
                                    <th width="60">張數</th>
                                    <th style="color:blue;">合計金額</th>
                                    <th style="color:green;">毛利</th>
                                </tr>
                            </thead>
                            <tbody id="daily-stats-list">
                                </tbody>
                            <tfoot style="background:#f1f5f9; font-weight:bold; position:sticky; bottom:0;">
                                <tr style="border-top:2px solid #cbd5e1;">
                                    <td style="text-align:center;">合計</td>
                                    <td id="d-total-sales" style="text-align:right;">0</td>
                                    <td id="d-total-count1" style="text-align:right;">0</td>
                                    <td id="d-total-return" style="text-align:right;">0</td>
                                    <td id="d-total-count2" style="text-align:right;">0</td>
                                    <td id="d-total-net" style="text-align:right; color:blue;">0</td>
                                    <td id="d-total-profit" style="text-align:right; color:green;">0</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>
<!-- 每日補貨統計內容 -->
            <div id="view-replenishment" style="display:none; flex-direction:column; align-items:center; padding-top:20px;">
                
                <div class="panel-box" style="width: 800px; display:flex; flex-direction:column; gap:15px; border-top: 4px solid var(--primary-color);">
                    
                    <div style="font-size:18px; font-weight:bold; color:var(--primary-color); border-bottom:1px solid #eee; padding-bottom:10px;">
                        <i class="fas fa-boxes"></i> 補貨統計條件設定
                    </div>

                    <div style="display:flex; gap:20px; flex-wrap:wrap;">
                        <div style="flex:1;">
                            <label class="tiny-label">日期範圍:</label>
                            <div style="display:flex; gap:5px; align-items:center;">
                                <input type="date" id="rep-date-start" class="header-input" style="width:100%">
                                <span>~</span>
                                <input type="date" id="rep-date-end" class="header-input" style="width:100%">
                            </div>
                        </div>
                        <div style="flex:1;">
                            <label class="tiny-label">商品代號範圍:</label>
                            <div style="display:flex; gap:5px; align-items:center;">
                                <input type="text" class="header-input" placeholder="起" style="width:100%">
                                <span>~</span>
                                <input type="text" class="header-input" placeholder="迄" style="width:100%">
                            </div>
                        </div>
                    </div>

                    <div>
                        <div style="display:flex; justify-content:space-between; align-items:center;">
                            <label class="tiny-label">供貨廠商代號 (留白表示全部):</label>
                            <span style="font-size:12px; color:red;">* 若全部空白表示全部都要</span>
                        </div>
                        <div class="supplier-grid">
                            <input type="text" class="header-input" placeholder="廠商1">
                            <input type="text" class="header-input" placeholder="廠商2">
                            <input type="text" class="header-input" placeholder="廠商3">
                            <input type="text" class="header-input" placeholder="廠商4">
                            <input type="text" class="header-input" placeholder="廠商5">
                            <input type="text" class="header-input" placeholder="廠商6">
                            <input type="text" class="header-input" placeholder="廠商7">
                            <input type="text" class="header-input" placeholder="廠商8">
                        </div>
                    </div>

                    <div style="display:grid; grid-template-columns: 1fr 1fr 1fr; gap:15px;">
                        
                        <div class="option-group">
                            <div class="option-title">列印售價</div>
                            <div style="display:flex; gap:15px;">
                                <label class="radio-label"><input type="radio" name="rep-price" value="Y" checked> R.列印</label>
                                <label class="radio-label"><input type="radio" name="rep-price" value="N"> N.不印</label>
                            </div>
                        </div>

                        <div class="option-group">
                            <div class="option-title">檢查庫存條件</div>
                            <div style="display:flex; flex-direction:column; gap:5px;">
                                <label class="radio-label"><input type="radio" name="rep-cond" value="0"> 庫存: 0</label>
                                <div style="display:flex; align-items:center; gap:5px;">
                                    <label class="radio-label"><input type="radio" name="rep-cond" value="L" checked> 庫存 < </label>
                                    <input type="number" class="small-input" value="10" style="width:60px;">
                                </div>
                                <label class="radio-label"><input type="radio" name="rep-cond" value="S"> F.安全庫存量</label>
                            </div>
                        </div>

                        <div class="option-group">
                            <div class="option-title">輸出選項</div>
                            <div style="display:flex; flex-direction:column; gap:5px;">
                                <label class="radio-label"><input type="radio" name="rep-output" value="S" checked> S.螢幕 (可轉採購單)</label>
                                <label class="radio-label"><input type="radio" name="rep-output" value="P"> P.印表機</label>
                                <label class="radio-label"><input type="radio" name="rep-output" value="D"> D.文件</label>
                            </div>
                        </div>
                    </div>

                    <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px; background:#f1f5f9; padding:10px; border-radius:6px;">
                        <div style="display:flex; align-items:center; gap:10px;">
                            <label>印表機:</label>
                            <select class="header-input" style="width:200px;"><option>Microsoft Print to PDF</option></select>
                        </div>
                        <div style="display:flex; gap:10px;">
                            <button class="btn btn-blue" onclick="runReplenishment()"><i class="fas fa-play"></i> G.開始</button>
                            <button class="btn btn-gray" onclick="switchMode('entry', document.querySelector('.top-pill.active'), '門市現銷作業')"><i class="fas fa-sign-out-alt"></i> Q.退出</button>
                        </div>
                    </div>
                </div>

                <div id="replenishment-result-panel" class="panel-box" style="width: 100%; margin-top:20px; display:none; flex-direction:column;">
                    <div class="grid-header-label">
                        <i class="fas fa-clipboard-list"></i> 補貨建議清單
                        <button class="btn btn-green" style="margin-left:auto; padding:2px 10px; font-size:12px;" onclick="alert('已轉成採購單!')">轉採購單</button>
                    </div>
                    <div class="grid-container" style="height: 300px; overflow:auto;">
                        <table class="browse-table">
                            <thead>
                                <tr>
                                    <th>商品代號</th>
                                    <th>商品名稱</th>
                                    <th>主要廠商</th>
                                    <th>目前庫存</th>
                                    <th>安全庫存</th>
                                    <th>建議進貨量</th>
                                    <th>售價</th>
                                </tr>
                            </thead>
                            <tbody id="replenishment-result-list">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
<!-- EXCEL商品匯入 -->
            <div id="view-import" style="display:none; flex-direction:column; gap:20px; padding:20px;">
                <div class="panel-box">
                    <div style="font-size:18px; font-weight:bold; margin-bottom:15px; border-bottom:1px solid #eee; padding-bottom:10px;">
                        <i class="fas fa-file-excel" style="color:#10b981"></i> 商品資料批次匯入
                    </div>
                    
                    <div style="display:flex; gap:10px; align-items:center;">
                        <input type="file" id="excel-file" accept=".xlsx, .xls" style="border:1px solid #ccc; padding:5px; border-radius:4px;">
                        <button class="btn btn-green" onclick="uploadExcel()">
                            <i class="fas fa-upload"></i> 開始匯入
                        </button>
                    </div>

                    <div style="margin-top:20px; background:#f8fafc; padding:15px; border-radius:5px; font-size:14px; color:#64748b;">
                        <strong><i class="fas fa-info-circle"></i> 匯入說明：</strong><br>
                        1. 請使用 Excel (.xlsx) 格式。<br>
                        2. 第一列為標題，資料從第二列開始。<br>
                        3. 欄位順序：<strong>A欄:商品代號 | B欄:商品名稱 | C欄:車種 | D欄:單價</strong>
                    </div>

                    <div id="import-result" style="margin-top:20px; white-space: pre-line; font-weight:bold;"></div>
                </div>
            </div>

            <div id="view-construction" style="display:none; flex-direction:column; align-items:center; justify-content:center; height:80%; color:#64748b;">
                <i class="fas fa-tools" style="font-size:60px; margin-bottom:20px; color:#cbd5e1;"></i>
                <h2 id="construction-title" style="margin-bottom:10px;">功能建置中</h2>
                <p>此功能即將推出，敬請期待！</p>
            </div>

        </div>
    </div>

    <script src="js/main.js"></script>
    <script src="js/sales.js"></script>
    <script src="js/browse.js"></script>

</body>
</html>