package com.example.demo;

import javax.sql.DataSource;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;
import org.springframework.jdbc.datasource.DriverManagerDataSource;

@SpringBootApplication
public class DemoApplication {

    public static void main(String[] args) {
        // é€™æ˜¯æ–°çš„å•Ÿå‹•è¨Šæ¯ï¼Œçœ‹åˆ°å®ƒä»£è¡¨æ›´æ–°æˆåŠŸ
        System.out.println("ğŸš€ æœ€çµ‚ç‰ˆï¼šæ–°å¯†ç¢¼ + IPv4 Session Mode (Port 5432) å•Ÿå‹•ä¸­...");
        SpringApplication.run(DemoApplication.class, args);
        System.out.println("âœ… ç¥¥æ˜“æ©Ÿè»Šææ–™è¡Œç³»çµ±å·²å•Ÿå‹•!");
        System.out.println("ğŸ‘‰ è«‹é–‹å•Ÿç¶²é : http://localhost:8080/");
    }

    @Bean
    public DataSource dataSource() {
        DriverManagerDataSource dataSource = new DriverManagerDataSource();
        
        dataSource.setDriverClassName("org.postgresql.Driver");
        
        // 1. è¨­å®šç¶²å€ï¼šä½¿ç”¨å®˜æ–¹æ¨è–¦çš„ Session Pooler (aws-1...) 
        // é€™æ˜¯æœ€ç©©å®šã€æ”¯æ´ IPv4 çš„è¨­å®š
        dataSource.setUrl("jdbc:postgresql://aws-1-ap-southeast-1.pooler.supabase.com:5432/postgres");
        
        // 2. å¸³è™Ÿ (æ‚¨çš„å°ˆæ¡ˆ ID)
        dataSource.setUsername("postgres.txowvwqkruzamxazosc");
        
        // 3. å¯†ç¢¼ (é€™æ˜¯æ‚¨å‰›å‰›æ”¹å¥½çš„æ–°å¯†ç¢¼ï¼)
        // æˆ‘å€‘ç›´æ¥å¯«æ­»åœ¨é€™è£¡ï¼Œä¿è­‰ç¨‹å¼ä¸€å®šè®€å¾—åˆ°
        dataSource.setPassword("Eason052334090");    
        return dataSource;
    }
}