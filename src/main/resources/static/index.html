<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>祥易行動查價</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* iOS 16 System Colors */
            --ios-bg: #F2F2F7;          /* 系統背景灰 */
            --ios-card: #FFFFFF;        /* 卡片白 */
            --ios-blue: #007AFF;        /* 系統藍 */
            --ios-green: #34C759;       /* 系統綠 */
            --ios-red: #FF3B30;         /* 系統紅 */
            --ios-gray: #8E8E93;        /* 系統灰 */
            --ios-gray-light: #E5E5EA;  /* 搜尋框底色 */
            --ios-separator: #C6C6C8;   /* 分隔線 */
            --text-primary: #000000;
            --text-secondary: #3C3C4399; /* 60% opacity */
            
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        * { box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial, sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body { 
            margin: 0; padding: 0; 
            background-color: var(--ios-bg); 
            color: var(--text-primary); 
            height: 100vh; 
            display: flex; 
            flex-direction: column; 
            overflow: hidden; 
        }

        /* === iOS 毛玻璃導航欄 === */
        .nav-bar {
            background: rgba(255, 255, 255, 0.85); /* 半透明白 */
            backdrop-filter: blur(20px); /* 毛玻璃特效 */
            -webkit-backdrop-filter: blur(20px);
            height: calc(44px + var(--safe-top));
            padding-top: var(--safe-top);
            border-bottom: 0.5px solid rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .nav-title {
            font-size: 17px;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* === 主要滾動區 === */
        .content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding-bottom: calc(20px + var(--safe-bottom));
        }

        /* === iOS 搜尋框 === */
        .search-container {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .search-wrapper {
            flex: 1;
            background-color: var(--ios-gray-light);
            border-radius: 10px;
            height: 36px;
            display: flex;
            align-items: center;
            padding: 0 8px;
            transition: 0.2s;
        }
        
        .search-wrapper:focus-within {
            background-color: #d1d1d6; /* 聚焦時稍微變深 */
        }

        .search-icon {
            color: var(--text-secondary);
            font-size: 14px;
            margin-right: 6px;
        }

        .search-input {
            border: none;
            background: transparent;
            font-size: 17px;
            width: 100%;
            outline: none;
            color: var(--text-primary);
        }
        
        .search-input::placeholder { color: var(--text-secondary); }

        .scan-btn {
            color: var(--ios-blue);
            background: none;
            border: none;
            font-size: 22px;
            padding: 5px;
            cursor: pointer;
        }

        /* === iOS 卡片風格 (Inset Grouped) === */
        .ios-card {
            background: var(--ios-card);
            border-radius: 12px;
            overflow: hidden; /* 讓子元素的圓角不溢出 */
            box-shadow: 0 1px 2px rgba(0,0,0,0.02); /* 極淡的陰影 */
            margin-bottom: 5px;
            display: none; /* 預設隱藏 */
            animation: popIn 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        @keyframes popIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        /* 商品標頭 */
        .product-header {
            padding: 16px;
            border-bottom: 0.5px solid var(--ios-separator);
        }
        .p-name { font-size: 20px; font-weight: 700; margin-bottom: 6px; line-height: 1.3; }
        .p-tags { display: flex; gap: 8px; }
        .ios-tag { 
            font-size: 12px; font-weight: 500; padding: 4px 8px; border-radius: 6px; 
            background: var(--ios-bg); color: var(--text-secondary);
        }
        .tag-blue { color: var(--ios-blue); background: rgba(0, 122, 255, 0.1); }

        /* 資訊網格 */
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            /* iOS 分隔線技巧 */
            background: var(--ios-separator);
            gap: 0.5px; 
            border-bottom: 0.5px solid var(--ios-separator);
        }
        .info-cell {
            background: var(--ios-card);
            padding: 12px;
            text-align: center;
        }
        .cell-label { font-size: 12px; color: var(--text-secondary); margin-bottom: 4px; }
        .cell-val { font-size: 20px; font-weight: 600; letter-spacing: -0.5px; }
        .text-red { color: var(--ios-red); }

        /* 價格選單 (類似 iOS 設定選項) */
        .price-list {
            display: flex;
            flex-direction: column;
        }
        .price-item {
            padding: 14px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--ios-card);
            cursor: pointer;
            transition: background 0.2s;
            position: relative;
        }
        
        /* 點擊回饋 */
        .price-item:active { background: #E5E5EA; }

        /* 內部分隔線 (不滿版) */
        .price-item:not(:last-child)::after {
            content: "";
            position: absolute;
            bottom: 0;
            right: 0;
            left: 16px; /* 左側留白 */
            height: 0.5px;
            background-color: var(--ios-separator);
        }

        .price-label { font-size: 16px; font-weight: 400; color: var(--text-primary); }
        .price-val { font-size: 18px; font-weight: 600; }
        .val-green { color: var(--ios-green); }
        .val-blue { color: var(--ios-blue); }
        .check-icon { 
            color: var(--ios-blue); 
            font-size: 18px; 
            opacity: 0; 
            transform: translateX(-10px);
            transition: 0.2s;
            margin-right: 10px;
        }
        
        /* 選中狀態 */
        .price-item.selected .check-icon { opacity: 1; transform: translateX(0); }
        .price-item.selected { background-color: #F2F8FF; }

        /* iOS 按鈕 */
        .ios-btn {
            background-color: var(--ios-blue);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 14px;
            font-size: 17px;
            font-weight: 600;
            width: 100%;
            margin-top: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 122, 255, 0.2);
        }
        .ios-btn:active { opacity: 0.7; transform: scale(0.98); }

        /* 歷史紀錄標題 */
        .section-header {
            font-size: 13px;
            color: var(--text-secondary);
            text-transform: uppercase;
            margin-left: 16px;
            margin-bottom: 6px;
            margin-top: 10px;
        }

        /* 歷史紀錄列表 (Inset Grouped) */
        .history-list {
            background: var(--ios-card);
            border-radius: 12px;
            overflow: hidden;
        }
        .h-item {
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }
        .h-item:not(:last-child)::after {
            content: ""; position: absolute; bottom: 0; right: 0; left: 16px;
            height: 0.5px; background-color: var(--ios-separator);
        }
        .h-left { display: flex; flex-direction: column; gap: 2px; }
        .h-title { font-size: 16px; font-weight: 500; }
        .h-sub { font-size: 12px; color: var(--text-secondary); }
        .h-right { text-align: right; }
        .h-price { font-size: 16px; font-weight: 600; color: var(--text-primary); }
        .h-tag { font-size: 11px; color: var(--ios-gray); }

        /* 空狀態 */
        .empty-state {
            text-align: center;
            color: var(--ios-gray);
            margin-top: 60px;
        }
        .empty-icon { font-size: 48px; margin-bottom: 15px; opacity: 0.3; }

    </style>
</head>
<body>

    <div class="nav-bar">
        <div class="nav-title">祥易行動查價</div>
    </div>

    <div class="content">
        
        <div class="search-container">
            <div class="search-wrapper">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="keyword" class="search-input" placeholder="搜尋代號或名稱" inputmode="text" onkeypress="if(event.key==='Enter') doSearch()">
            </div>
            <button class="scan-btn" onclick="mockScan()">
                <i class="fas fa-barcode"></i>
            </button>
        </div>

        <div id="empty-hint" class="empty-state">
            <i class="fas fa-search empty-icon"></i>
            <p>輸入關鍵字或掃描條碼</p>
        </div>

        <div id="result-card" class="ios-card">
            <div class="product-header">
                <div class="p-name" id="d-name">--</div>
                <div class="p-tags">
                    <span class="ios-tag tag-blue" id="d-car">--</span>
                    <span class="ios-tag" id="d-code">--</span>
                </div>
            </div>

            <div class="info-grid">
                <div class="info-cell">
                    <div class="cell-label">目前庫存</div>
                    <div class="cell-val text-red" id="d-stock">--</div>
                </div>
                <div class="info-cell">
                    <div class="cell-label">儲位編號</div>
                    <div class="cell-val" id="d-loc">--</div>
                </div>
            </div>

            <div class="price-list">
                <div class="price-item selected" id="row-retail" onclick="selectPrice('retail')">
                    <div style="display:flex; align-items:center;">
                        <i class="fas fa-check check-icon" id="icon-retail"></i>
                        <span class="price-label">散客價</span>
                    </div>
                    <span class="price-val val-green" id="d-price1">$0</span>
                </div>
                
                <div class="price-item" id="row-peer" onclick="selectPrice('peer')">
                    <div style="display:flex; align-items:center;">
                        <i class="fas fa-check check-icon" id="icon-peer"></i>
                        <span class="price-label">車行價</span>
                    </div>
                    <span class="price-val val-blue" id="d-price2">$0</span>
                </div>
            </div>
        </div>

        <div id="action-area" style="display:none;">
            <button class="ios-btn" onclick="addToList()">
                <i class="fas fa-arrow-down"></i> 加入紀錄列表
            </button>
        </div>

        <div id="history-section" style="display:none;">
            <div class="section-header">最近查詢</div>
            <div class="history-list" id="history-list">
                </div>
        </div>

    </div>

    <script>
        let currentItem = null;
        let selectedPriceType = 'retail'; // 預設散客

        function mockScan() {
            const input = document.getElementById('keyword');
            input.value = "P-2026-" + Math.floor(Math.random() * 900 + 100);
            doSearch();
        }

        function doSearch() {
            const val = document.getElementById('keyword').value.trim();
            if(!val) return;

            // 切換介面顯示
            document.getElementById('empty-hint').style.display = 'none';
            document.getElementById('action-area').style.display = 'block';
            
            // 重新觸發卡片動畫
            const card = document.getElementById('result-card');
            card.style.display = 'none';
            
            // 模擬資料
            const basePrice = Math.floor(Math.random() * 500) + 100;
            currentItem = {
                name: "三代勁戰陶瓷煞車皮 (模擬)",
                car: "勁戰/GTR",
                code: val.toUpperCase(),
                stock: Math.floor(Math.random() * 50),
                loc: "A-0" + Math.floor(Math.random()*9) + "-12",
                price1: Math.round(basePrice * 2),   // 散客
                price2: Math.round(basePrice * 1.5)  // 車行
            };

            // 填入資料
            document.getElementById('d-name').innerText = currentItem.name;
            document.getElementById('d-car').innerText = currentItem.car;
            document.getElementById('d-code').innerText = currentItem.code;
            document.getElementById('d-stock').innerText = currentItem.stock;
            document.getElementById('d-loc').innerText = currentItem.loc;
            document.getElementById('d-price1').innerText = "$" + currentItem.price1.toLocaleString();
            document.getElementById('d-price2').innerText = "$" + currentItem.price2.toLocaleString();

            // 重置價格選擇
            selectPrice('retail');

            // 顯示卡片
            setTimeout(() => card.style.display = 'block', 50);

            // 收鍵盤
            document.getElementById('keyword').value = "";
            document.getElementById('keyword').blur();
        }

        function selectPrice(type) {
            selectedPriceType = type;
            
            // 更新 UI 樣式
            document.getElementById('row-retail').classList.toggle('selected', type === 'retail');
            document.getElementById('row-peer').classList.toggle('selected', type === 'peer');
        }

        function addToList() {
            if(!currentItem) return;

            document.getElementById('history-section').style.display = 'block';
            const list = document.getElementById('history-list');
            
            // 決定顯示價格
            const finalPrice = selectedPriceType === 'retail' ? currentItem.price1 : currentItem.price2;
            const typeLabel = selectedPriceType === 'retail' ? '散客' : '車行';
            const priceColor = selectedPriceType === 'retail' ? 'val-green' : 'val-blue';

            const div = document.createElement('div');
            div.className = 'h-item';
            div.innerHTML = `
                <div class="h-left">
                    <div class="h-title">${currentItem.name}</div>
                    <div class="h-sub">${currentItem.code}</div>
                </div>
                <div class="h-right">
                    <div class="h-price ${priceColor}">$${finalPrice.toLocaleString()}</div>
                    <div class="h-tag">${typeLabel}</div>
                </div>
            `;
            
            // 插入最上方
            list.insertBefore(div, list.firstChild);
        }
    </script>
</body>
</html>